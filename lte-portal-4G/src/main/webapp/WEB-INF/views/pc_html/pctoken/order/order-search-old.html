<@override name="title">中国电信4G营业受理</@override> 
<@override name="header">
<#include "/pcpublic/busi-js-tpl.html"/>
</@override>
<@override name="content">
<h2 class="h2_title" id="deal_package" >
	<span>办套餐</span>
	<!--  <a href="javascript:order.phoneNumber.initPage();" class="numberSearch back3"><span>返回</span></a>-->
	<!-- <#if subPage??>
	<#else>
	<a href="javascript:order.prepare.backToInit();" class="numberSearch back3" id="backbtn"><span>返回</span></a>
	</#if> -->
</h2>
<div class="order" id="order_prod_list" >
	<div class="order_content" style="border: none; padding: 10px">
		<!--选套餐-->
		<div class="order_tab_panel" style="display: block">
			<div class="selectList">
				<dl>
					<dt>
						选择套餐：
					</dt>
					<dd>
						<input type="text" id="searchtext" class="numberTextBox width330" maxlength="11" value="请输入您要搜索的套餐名称或首字母简拼"
							onblur="javascript:if($(this).val()==''){$(this).val('请输入您要搜索的套餐名称或首字母简拼');}" 
							onfocus="javascript:if($(this).val()=='请输入您要搜索的套餐名称或首字母简拼'){$(this).val('')}"/>
						<input type="hidden" id="subpageFlag" value="${subPage?default("")}">
						<input type="hidden" id="numsubflag" value="${numsubflag?default("")}">
						<input type="button" id="search" value="搜&nbsp;索" class="numberSearch" />
					</dd>
				</dl>
                <dl>
                     <dt>价格范围：</dt>
                     <dd id="price_basic" style="width: 700px;">
					 </dd>
					 <dd id="price_all" style="display: none;width: 700px;" >
				     </dd>
				     <span id="price_more" style="display: none;">
				     <a href="javascript:void(0);" val="更多" class="btn_price_more" style="display: none;">展开</a>
				     </span>
				     <div class="clear"></div>
                 </dl>
                 <dl>
                     <dt>流量范围：</dt>
                     <dd id="influx_basic" style="width: 700px;">
					 </dd>
					 <dd id="influx_all" style="display: none;width: 700px;" >
				     </dd>
				     <span id="influx_more" style="display: none;">
				     <a href="javascript:void(0);" val="更多" class="btn_influx_more" style="display: none;">展开</a>
				     </span>
				     <div class="clear"></div>
                 </dl>
				 <dl class="noBorder">
                     <dt>语音分钟数：</dt>
                     <dd id="invoice_basic" style="width: 700px;">
					 </dd>
					 <dd id="invoice_all" style="display: none;width: 700px;" >
				     </dd>
				     <span id="invoice_more" style="display: none;">
				     <a href="javascript:void(0);" val="更多" class="btn_invoice_more" style="display: none;">展开</a>
				     </span>
				     <div class="clear"></div>
                 </dl>
				
				
			</div>
			<!-- 主套餐内容 -->
			<div class="contract_tab_panel" style="display: block;" id="service_detial">
			</div>
			<!--上下步按钮-->
			<div align="right" style="margin: 20px auto;">
			</div>
			<!--上下步按钮 end-->
		</div>
		<!--选套餐 end-->
	</div>
</div>
<!-- 销售品构成-->  
<div id="div_member_dialog" class="easyDialogdiv" style="width:650px;height:420px;z-index: 1" id="yilai_dialog" >
	<div class="easyDialogclose" onclick="easyDialog.close()"></div>
  	<table class="contract_list rule">
    	<thead>
       		<tr>
                <td colspan="2" id="memberName"></td>
            </tr>                                                    
         </thead>
  	</table>	          	
  	<br/>
  	<div id="main_member_div" class="fs_choosed">
		
	</div>
  	
  	<div align="center" style="margin: 20px auto;">
		<a class="btna_o" href="javascript:void(0)"><span id="memberSpan">确认</span></a>
		<a class="btna_o" href="javascript:void(0)" style=" margin-left:20px;" onclick="easyDialog.close()"><span>取消</span></a>
	</div>
</div>
<!--弹出框的内容-->
<div class="easyDialogdiv" style="width:700px;height:450px;" id="member_dialog" >
	
  	<table class="contract_list rule">
        <thead>
            <tr>
                <td colspan="2" id="main_title"></td>
            </tr>                                                    
        </thead>
  	</table>
  	<br/>
  	<div class="form-content">
	    <div class="phone_warp" style="margin:0px 10px;">
	    	<table class="numberList">
	        	<tbody id="member_tbody">	
	        	</tbody>
	      	</table>
	      	<div align="center" style="margin: 20px auto;">
	      		<a href="javascript:void(0)" id="member_btn" class="btna_o"><span>确认</span></a>
	      		<a class="btna_o" id="closeBtn" href="javascript:void(0)" style=" margin-left:20px;display: none;" onclick="easyDialog.close()"><span>取消</span></a>
	      	</div>
	    </div>
  	</div>
</div>
<!--弹出款-使用人-->
<div id="choose_user_dialog" class="easyDialogdiv" style="width:700px;height:250px;">
    <div class="easyDialogclose" id="chooseUserClose" onclick="easyDialog.close()"></div>
    <table class="contract_list">
        <thead>
        <tr>
            <td>选择使用人</td>
        </tr>                                                    
        </thead>
    </table>
    <div class="main_div location main_warp">
        <ul class="fillin show" style="overflow: hidden;">
    <li style="padding-right: 50%;">
		<label>证件类型：</label>
        <select id="orderIdentidiesTypeCdB" onchange="order.cust.identidiesTypeCdChoose(this,'orderUserIdCard')">
        </select>
        <label class="f_red">*</label>
        <a class="btn_h30" id="orderUserReadCertBtn" onclick="javascript:order.cust.readCertWhenUser()" style="margin-top: 0px; display: none;"><span>读 卡</span></a>
        <a class="btn_h30" id="orderUserQryBtn" onclick="javascript:order.cust.qryUserCustInfo()" style="margin-top: 0px; display: none;"><span>查询</span></a>
	</li>
	<!-- 经办人为个人用户，证件类型只显示个人证件类型，隐藏客户类型 -->
	<li id="li_order_remark" style="display: none;">
		<label>客户类型：</label> 
		<select id="orderPartyTypeCdB" onchange="order.cust.partyTypeCdChoose(this,'orderIdentidiesTypeCd')">
                                        <option value="1" >个人</option>
        </select>
        <label class="f_red">*</label>
	</li>
	<li id="li_order_user">
		<label>使用人姓名：</label> 
		<input id="orderUserName" class="inputWidth183px" maxlength="16" type="text" style="width:183px;">
		<span style="line-height: 28px; float:left;"></span>
		<label class="f_red">*</label>
	</li>
	<li id="li_order_user2">
		<label>证件号码：</label> 
		<input id="orderUserIdCard" class="inputWidth183px"maxlength="50"type="text" style="width:183px;">
		<span style="line-height: 28px; float:left;"></span>
		<label class="f_red">*</label>
	</li>
	<li id="li_order_user3">
		<label>证件地址：</label> 
		<input id="orderUserAddr" class="inputWidth183px" maxlength="125"type="text" style="width:183px;">
		<span style="line-height: 28px; float:left;"></span>
		<label class="f_red">*</label>
	</li>
	<li>
		<label>联系人号码：</label> 
		<input id="orderUserPhoneNbr" class="inputWidth183px" type="text" maxlength="16"style="width:183px;">
	</li>
</ul>
   <input id="user_prodId" type="hidden" value="">
	</div>
  	<div align="center" style="margin: 20px auto;">
        <a id="chooseUserBt" class="btna_o" ><span >确认</span></a>
        <a id="cancelChooseUserBtn" class="btna_o" href="javascript:void(0)" style=" margin-left:20px;" onclick="easyDialog.close()"><span>取消</span></a>
    </div>
</div>
<!--弹出款-使用人 end-->

<!--用户鉴权弹窗-->
	<div class="easyDialogdiv" style="height:300px;display:none" id="auth">
	<div class="easyDialogclose" id="authClose"></div>
	<form id="custAuthForm">
	<h1 class="easyDialogTitle">客户身份鉴权</h1>
	<div class="infoBox">
		<table class="network">
                          <tbody>
                          <tr>
                                <td width="100"><label class="f_red">*</label><label id="custAuthTypeName">产品密码：</label></td>
                                <td width="300"><input id="authPassword" type="password" placeHolder="请输入密码" data-validate="validate(required:密码不能为空, maxlength:密码长度最多为{arg1}(12)) on(blur)" class="inputWidth150px"><a  class="purchase" id="custAuthbtn" href="javascript:void(0)">校验</a><a class="purchase" id="jumpAuth" style="display:none" onclick="order.cust.jumpAuth()">跳过校验</a>
                                </td>
                          </tr>   

                        </tbody>
         </table>
    </div>
    </form>
	</div>
<!--用户鉴权弹窗 end-->

<!--订单准备 end-->
<script type="text/javascript">
window.onload=function(){
	var p_cust_areaid = "";
	var p_cust_areaname= "";
	var nextFlag = false;
	var mergeFlag = "${mergeFlag}";
	var custInfos = ${custInfo};
	var mainPhoneNum = $("#mainPhoneNum").val();
	var newSubPhoneNum = $("#newSubPhoneNum").val();
	if(mainPhoneNum!=undefined &&mainPhoneNum!=""){
		OrderInfo.newOrderNumInfo.mainPhoneNum = mainPhoneNum;
	}
	if(newSubPhoneNum!=undefined&&newSubPhoneNum!=""){
		OrderInfo.newOrderNumInfo.newSubPhoneNum = newSubPhoneNum;
	}
	if("${prodOfferId}"!=""){
		OrderInfo.offid="${prodOfferId}";
		//order.service.buyService('${prodOfferId}','${(price)?default("")}');
	}
	var terminalCode='${terminalCode}'; //终端串码
	//终端串码
	if(terminalCode!=null && terminalCode!="" && terminalCode!="null"){
		OrderInfo.terminalCode=terminalCode;
	}
	OrderInfo.typeCd="${typeCd}";
	OrderInfo.verifyLevel='${verifyLevel}';
	if(mergeFlag=="0"){
		$.each(custInfos.custInfos,function(index,custInfo){
			var addressStr=custInfo.addressStr;
			var areaId=custInfo.areaId;
			p_cust_areaid = custInfo.areaId;
			var areaName=custInfo.areaName;
			p_cust_areaname = areaName;
			var authFlag="1";
			var custFlag=custInfo.custFlag;
			var custId=custInfo.custId;
			var idCardNumber=custInfo.idCardNumber;
			var identityCd=custInfo.identityCd;
			var identityName=custInfo.identityName;
			var norTaxPayer="";
			var partyName=custInfo.partyName;
			var segmentId=custInfo.segmentId;
			var segmentName=custInfo.segmentName;
			var vipLevel=custInfo.vipLevel;
			var vipLevelName=custInfo.vipLevelName;
			OrderInfo.cust={addressStr: addressStr,areaId: areaId,areaName: areaName,authFlag: "1",custFlag: custFlag,custId: custId,idCardNumber: idCardNumber,identityCd: identityCd,identityName: identityName,norTaxPayer: "",partyName: partyName,segmentId: segmentId,segmentName: segmentName,vipLevel: vipLevel,vipLevelName: vipLevelName};
			nextFlag = true;
		});
	}else{
		var custNumber = "${custNumber}";
		var provCustAreaId = "${provCustAreaId}";
		nextFlag = order.cust.queryCustCompreInfo(custNumber,provCustAreaId,1,'');
		p_cust_areaid = OrderInfo.cust.areaId;
		p_cust_areaname = OrderInfo.cust.areaName;
	}
	$("#p_cust_areaId").val(p_cust_areaid);
	if(nextFlag){
	    	
		OrderInfo.provinceInfo.provIsale = '${provIsale}';
		OrderInfo.provinceInfo.redirectUri = '${redirectUri}';
		OrderInfo.provinceInfo.isFee = '${isFee}';
		OrderInfo.provinceInfo.mergeFlag = "${mergeFlag}";
		OrderInfo.provinceInfo.salesCode = "${salesCode}";
		OrderInfo.actionFlag=1;
		OrderInfo.newOrderNumInfo.mktResInstCode = '${mktResInstCode}';
		OrderInfo.oldSubPhoneNum.oldSubPhoneNum='${oldSubPhoneNum}';
		OrderInfo.provinceInfo.codeMsg = '${codeMsg}';
		OrderInfo.acct={acctCd:'${acctCd}'};//账户合同号
		order.prepare.createorderlonger();
		OrderInfo.busitypeflag=1;
		order.prodModify.querySecondBusinessAuth();
	}
}
</script>
	<!-- 选号界面需要获取的 areaId -->
	<input type="hidden" id="p_cust_areaId" value="">
	<!-- 主卡号码 -->
	<input type="hidden" id="mainPhoneNum" value="${mainPhoneNum}"/>
	<!-- 副卡号码 -->
	<input type="hidden" id="newSubPhoneNum" value="${newSubPhoneNum}"/>
	<input type="hidden" id="old_offerSpecId" value="${prodOfferId}">	
  	<div class="main_warp" id="order_tab_panel_content" style="display:none">
        
    </div>
    <!-- 填单页面用 -->
    <div class="main_warp" id="order_fill_content" style="display:none">
    
    </div>
    <!-- 订单确认页面-->
    <div class="main_warp" id="order_confirm" style="display:none"></div>
    
    <!-- 订单确认页面（分段受理专用）-->
    <div class="main_warp" id="step_order_confirm" style="display:none"></div>
    
    <!--弹出款-选择号码的内容-->
	<div style="display:none" id="ec-dialog-form-container-phonenumber" class="ec-dialog-form-container">
	  <div class="ec-dialog-form-top">
	    <h1 class="ec-dialog-form-title">选择号码</h1>
	  </div>
	  <div class="ec-dialog-form-content">
	    <div class="ec-dialog-form-loading" style="display:none"></div>
	    <div class="ec-dialog-form-message" style="display:none"></div>
	    <div class="ec-dialog-form-form" >
	      <form action="#" style="" id="dialogForm">
	        <div class="form-content" id="phonenumberContent" style="min-height:200px">      
	        </div>
	      </form>
	    </div>
	  </div>
	  <div class="ec-dialog-form-bottom"></div>
	</div>
	<!-- 选择号码弹出框结束 -->
	<!--帐户选择弹窗-->
	<div class="easyDialogdiv" style="width:1080px;height:460px;" id="div_staff_dialog">
	
	</div>
	<!-- 发展人管理弹窗 -->  
	<div id="div_attach_dialog" class="easyDialogdiv" style="width:980px;height:460px;">
		<div class="easyDialogclose" id="staff_dialog_close" onclick="easyDialog.close()"></div>
		<table class="contract_list">
			<thead>
				<tr><td><input type="checkbox" name="attach_dealer_check_all" onclick="order.dealer.checkAllAttach(this)">操作</td><td>号码</td><td>发展业务</td></tr>
			</thead>
			<tbody id="attach_tbody">
			</tbody>
		</table>
		<div align="center" style="margin: 20px auto;">
			<a class="btna_o" href="javascript:void(0)" onclick="order.dealer.addAttachDealer()"><span>确认</span></a>
			<a class="btna_o" href="javascript:void(0)" onclick="easyDialog.close()" style=" margin-left:20px;"><span>取消</span></a>
		</div>
	</div>
		<!--用户鉴权弹窗-->
<div style="height:300px;display:none;background:#fff; -webkit-border-radius:5px; -moz-border-radius:5px; border-radius:5px;-webkit-box-shadow:0 8px 8px rgba(0,0,0,0.4);-moz-box-shadow:0 8px 8px rgba(0,0,0,0.4);box-shadow:0 8px 8px rgba(0,0,0,0.4); border:5px solid #cbced0;
	display:none;
	overflow-y:auto;" id="auth2">
</div>
	<!-- 功能产品销售品详情弹窗 -->
	<div id="div_detail_dialog" class="easyDialogdiv" style="width:980px;height:460px;">
		<div class="easyDialogclose" id="staff_dialog_close" onclick="easyDialog.close()"></div>
		<table class="contract_list">
			<thead>
				<tr><td>产品名称</td><td>描述</td></tr>
			</thead>
			<tbody id="detail_tbody">
			</tbody>
		</table>
		<div align="center" style="margin: 20px auto;">
			<a class="btna_o" href="javascript:void(0)" onclick="easyDialog.close()" style=" margin-left:20px;"><span>返回</span></a>
		</div>
	</div> 
</@override>
<@extends name="/pcpublic/main-template.html"/>
<script type="text/javascript">


	
	


</script> 
