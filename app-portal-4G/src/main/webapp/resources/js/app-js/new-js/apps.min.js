var handleSlimScroll=function(){$("[data-scrollbar=true]").each(function(){generateSlimScroll($(this))})};var generateSlimScroll=function(c){var a=$(c).attr("data-height");a=(!a)?$(c).height():a;var b={height:a,alwaysVisible:true};if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){$(c).css("height",a);$(c).css("overflow-x","scroll")}else{$(c).slimScroll(b)}};var handleSidebarMenu=function(){$(".sidebar .nav > .has-sub > a").click(function(){var b=$(this).next(".sub-menu");var a=".sidebar .nav > li.has-sub > .sub-menu";if($(".page-sidebar-minified").length===0){$(a).not(b).slideUp(250,function(){$(this).closest("li").removeClass("expand")});$(b).slideToggle(250,function(){var c=$(this).closest("li");if($(c).hasClass("expand")){$(c).removeClass("expand")}else{$(c).addClass("expand")}})}});$(".sidebar .nav > .has-sub .sub-menu li.has-sub > a").click(function(){if($(".page-sidebar-minified").length===0){var a=$(this).next(".sub-menu");$(a).slideToggle(250)}})};var handleMobileSidebarToggle=function(){var a=false;$(".sidebar").on("click touchstart",function(b){if($(b.target).closest(".sidebar").length!==0){a=true}else{a=false;b.stopPropagation()}});$(document).on("click touchstart",function(b){if($(b.target).closest(".sidebar").length===0){a=false}if(!b.isPropagationStopped()&&a!==true){if($("#page-container").hasClass("page-sidebar-toggled")){a=true;$("#page-container").removeClass("page-sidebar-toggled")}if($("#page-container").hasClass("page-right-sidebar-toggled")){a=true;$("#page-container").removeClass("page-right-sidebar-toggled")}}});$("[data-click=right-sidebar-toggled]").click(function(d){d.stopPropagation();var b="#page-container";var c="page-right-sidebar-collapsed";c=($(window).width()<979)?"page-right-sidebar-toggled":c;if($(b).hasClass(c)){$(b).removeClass(c)}else{if(a!==true){$(b).addClass(c)}else{a=false}}if($(window).width()<480){$("#page-container").removeClass("page-sidebar-toggled")}});$("[data-click=sidebar-toggled]").click(function(d){d.stopPropagation();var c="page-sidebar-toggled";var b="#page-container";if($(b).hasClass(c)){$(b).removeClass(c)}else{if(a!==true){$(b).addClass(c)}else{a=false}}if($(window).width()<480){$("#page-container").removeClass("page-right-sidebar-toggled")}})};var handleSidebarMinify=function(){$("[data-click=sidebar-minify]").click(function(c){c.preventDefault();var b="page-sidebar-minified";var a="#page-container";if($(a).hasClass(b)){$(a).removeClass(b);if($(a).hasClass("page-sidebar-fixed")){generateSlimScroll($('#sidebar [data-scrollbar="true"]'));$("#sidebar [data-scrollbar=true]").trigger("mouseover");$("#sidebar [data-scrollbar=true]").stop();$("#sidebar [data-scrollbar=true]").css("margin-top","0")}}else{$(a).addClass(b);if(!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){if($(a).hasClass("page-sidebar-fixed")){$('#sidebar [data-scrollbar="true"]').slimScroll({destroy:true});$('#sidebar [data-scrollbar="true"]').removeAttr("style")}$("#sidebar [data-scrollbar=true]").trigger("mouseover")}else{$('#sidebar [data-scrollbar="true"]').css("margin-top","0");$('#sidebar [data-scrollbar="true"]').css("overflow","visible")}}$(window).trigger("resize")})};var handlePageContentView=function(){$.when($("#page-loader").addClass("hide")).done(function(){$("#page-container").addClass("in")})};var handlePanelAction=function(){$("[data-click=panel-remove]").hover(function(){$(this).tooltip({title:"删除",placement:"bottom",trigger:"hover",container:"body"});$(this).tooltip("show")});$("[data-click=panel-remove]").click(function(a){a.preventDefault();$(this).tooltip("destroy");$(this).closest(".panel").remove()});$("[data-click=panel-collapse]").hover(function(){$(this).tooltip({title:"展开/收缩",placement:"bottom",trigger:"hover",container:"body"});$(this).tooltip("show")});$("[data-click=panel-collapse]").click(function(a){a.preventDefault();$(this).closest(".panel").find(".panel-body").slideToggle()});$("[data-click=panel-reload]").hover(function(){$(this).tooltip({title:"刷新",placement:"bottom",trigger:"hover",container:"body"});$(this).tooltip("show")});$("[data-click=panel-reload]").click(function(d){d.preventDefault();var c=$(this).closest(".panel");if(!$(c).hasClass("panel-loading")){var a=$(c).find(".panel-body");var b='<div class="panel-loader"><span class="spinner-small"></span></div>';$(c).addClass("panel-loading");$(a).prepend(b);setTimeout(function(){$(c).removeClass("panel-loading");$(c).find(".panel-loader").remove()},2000)}});$("[data-click=panel-expand]").hover(function(){$(this).tooltip({title:"全屏/缩放",placement:"bottom",trigger:"hover",container:"body"});$(this).tooltip("show")});$("[data-click=panel-expand]").click(function(g){g.preventDefault();var f=$(this).closest(".panel");var b=$(f).find(".panel-body");var c=40;if($(b).length!==0){var h=$(f).offset().top;var d=$(b).offset().top;c=d-h}if($("body").hasClass("panel-expand")&&$(f).hasClass("panel-expand")){$("body, .panel").removeClass("panel-expand");$(".panel").removeAttr("style");$(b).removeAttr("style")}else{$("body").addClass("panel-expand");$(this).closest(".panel").addClass("panel-expand");if($(b).length!==0&&c!=40){var a=40;$(f).find(" > *").each(function(){var e=$(this).attr("class");if(e!="panel-heading"&&e!="panel-body"){a+=$(this).height()+30}});if(a!=40){$(b).css("top",a+"px")}}}$(window).trigger("resize")})};var handleDraggablePanel=function(){var b=$(".panel").parent("[class*=col]");var a=".panel-heading";var c=".row > [class*=col]";$(b).sortable({handle:a,connectWith:c,stop:function(d,e){e.item.find(".panel-title").append('<i class="fa fa-refresh fa-spin m-l-5" data-id="title-spinner"></i>');handleSavePanelPosition(e.item)}})};var handelTooltipPopoverActivation=function(){$("[data-toggle=tooltip]").tooltip();$("[data-toggle=popover]").popover()};var handleScrollToTopButton=function(){$(document).scroll(function(){var a=$(document).scrollTop();if(a>=200){$("[data-click=scroll-top]").addClass("in")}else{$("[data-click=scroll-top]").removeClass("in")}});$("[data-click=scroll-top]").click(function(a){a.preventDefault();$("html, body").animate({scrollTop:$("body").offset().top},500)})};var handleThemePageStructureControl=function(){if($.cookie&&$.cookie("theme")){if($(".theme-list").length!==0){$(".theme-list [data-theme]").closest("li").removeClass("active");$('.theme-list [data-theme="'+$.cookie("theme")+'"]').closest("li").addClass("active")}var a="assets/css/theme/"+$.cookie("theme")+".css";$("#theme").attr("href",a)}if($.cookie&&$.cookie("sidebar-styling")){if($(".sidebar").length!==0&&$.cookie("sidebar-styling")=="grid"){$(".sidebar").addClass("sidebar-grid");$('[name=sidebar-styling] option[value="2"]').prop("selected",true)}}if($.cookie&&$.cookie("header-styling")){if($(".header").length!==0&&$.cookie("header-styling")=="navbar-inverse"){$(".header").addClass("navbar-inverse");$('[name=header-styling] option[value="2"]').prop("selected",true)}}if($.cookie&&$.cookie("content-gradient")){if($("#page-container").length!==0&&$.cookie("content-gradient")=="enabled"){$("#page-container").addClass("gradient-enabled");$('[name=content-gradient] option[value="2"]').prop("selected",true)}}if($.cookie&&$.cookie("content-styling")){if($("body").length!==0&&$.cookie("content-styling")=="black"){$("body").addClass("flat-black");$('[name=content-styling] option[value="2"]').prop("selected",true)}}$(".theme-list [data-theme]").live("click",function(){var b="assets/css/theme/"+$(this).attr("data-theme")+".css";$("#theme").attr("href",b);$(".theme-list [data-theme]").not(this).closest("li").removeClass("active");$(this).closest("li").addClass("active");$.cookie("theme",$(this).attr("data-theme"))});$(".theme-panel [name=header-styling]").live("change",function(){var b=($(this).val()==1)?"navbar-default":"navbar-inverse";var c=($(this).val()==1)?"navbar-inverse":"navbar-default";$("#header").removeClass(c).addClass(b);$.cookie("header-styling",b)});$(".theme-panel [name=sidebar-styling]").live("change",function(){if($(this).val()==2){$("#sidebar").addClass("sidebar-grid");$.cookie("sidebar-styling","grid")}else{$("#sidebar").removeClass("sidebar-grid");$.cookie("sidebar-styling","default")}});$(".theme-panel [name=content-gradient]").live("change",function(){if($(this).val()==2){$("#page-container").addClass("gradient-enabled");$.cookie("content-gradient","enabled")}else{$("#page-container").removeClass("gradient-enabled");$.cookie("content-gradient","disabled")}});$(".theme-panel [name=content-styling]").live("change",function(){if($(this).val()==2){$("body").addClass("flat-black");$.cookie("content-styling","black")}else{$("body").removeClass("flat-black");$.cookie("content-styling","default")}});$(".theme-panel [name=sidebar-fixed]").live("change",function(){if($(this).val()==1){if($(".theme-panel [name=header-fixed]").val()==2){alert("Default Header with Fixed Sidebar option is not supported. Proceed with Fixed Header with Fixed Sidebar.");$('.theme-panel [name=header-fixed] option[value="1"]').prop("selected",true);$("#header").addClass("navbar-fixed-top");$("#page-container").addClass("page-header-fixed")}$("#page-container").addClass("page-sidebar-fixed");if(!$("#page-container").hasClass("page-sidebar-minified")){generateSlimScroll($('.sidebar [data-scrollbar="true"]'))}}else{$("#page-container").removeClass("page-sidebar-fixed");if($(".sidebar .slimScrollDiv").length!==0){if($(window).width()<=979){$(".sidebar").each(function(){if(!($("#page-container").hasClass("page-with-two-sidebar")&&$(this).hasClass("sidebar-right"))){$(this).find(".slimScrollBar").remove();$(this).find(".slimScrollRail").remove();$(this).find('[data-scrollbar="true"]').removeAttr("style");var b=$(this).find('[data-scrollbar="true"]').parent();var c=$(b).html();$(b).replaceWith(c)}})}else{if($(window).width()>979){$('.sidebar [data-scrollbar="true"]').slimScroll({destroy:true});$('.sidebar [data-scrollbar="true"]').removeAttr("style")}}}if($("#page-container .sidebar-bg").length===0){$("#page-container").append('<div class="sidebar-bg"></div>')}}});$(".theme-panel [name=header-fixed]").live("change",function(){if($(this).val()==1){$("#header").addClass("navbar-fixed-top");$("#page-container").addClass("page-header-fixed");$.cookie("header-fixed",true)}else{if($(".theme-panel [name=sidebar-fixed]").val()==1){alert("Default Header with Fixed Sidebar option is not supported. Proceed with Default Header with Default Sidebar.");$('.theme-panel [name=sidebar-fixed] option[value="2"]').prop("selected",true);$("#page-container").removeClass("page-sidebar-fixed");if($("#page-container .sidebar-bg").length===0){$("#page-container").append('<div class="sidebar-bg"></div>')}}$("#header").removeClass("navbar-fixed-top");$("#page-container").removeClass("page-header-fixed");$.cookie("header-fixed",false)}})};var handleThemePanelExpand=function(){$('[data-click="theme-panel-expand"]').live("click",function(){var a=".theme-panel";var b="active";if($(a).hasClass(b)){$(a).removeClass(b)}else{$(a).addClass(b)}})};var handleAfterPageLoadAddClass=function(){if($("[data-pageload-addclass]").length!==0){$(window).load(function(){$("[data-pageload-addclass]").each(function(){var a=$(this).attr("data-pageload-addclass");$(this).addClass(a)})})}};var handleSavePanelPosition=function(b){if($(".ui-sortable").length!==0){var c=[];var a=0;$.when($(".ui-sortable").each(function(){var d=$(this).find("[data-sortable-id]");if(d.length!==0){var e=[];$(d).each(function(){var f=$(this).attr("data-sortable-id");e.push({id:f})});c.push(e)}else{c.push([])}a++})).done(function(){var d=window.location.href;d=d.split("?");d=d[0];localStorage.setItem(d,JSON.stringify(c));$(b).find('[data-id="title-spinner"]').delay(500).fadeOut(500,function(){$(this).remove()})})}};var handleLocalStorage=function(){if(typeof(Storage)!=="undefined"){var c=window.location.href;c=c.split("?");c=c[0];var a=localStorage.getItem(c);if(a){a=JSON.parse(a);var b=0;$(".panel").parent('[class*="col-"]').each(function(){var e=a[b];var d=$(this);if(e){$.each(e,function(g,i){var f='[data-sortable-id="'+i.id+'"]';if($(f).length!==0){var h=$(f).clone();$(f).remove();$(d).append(h)}})}b++})}}else{alert("Your browser is not supported with the local storage")}};var handleResetLocalStorage=function(){$("[data-click=reset-local-storage]").live("click",function(a){a.preventDefault();var b='<div class="modal fade" data-modal-id="reset-local-storage-confirmation">    <div class="modal-dialog">        <div class="modal-content">            <div class="modal-header">                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>                <h4 class="modal-title"><i class="fa fa-refresh m-r-5"></i> 重置样式</h4>            </div>            <div class="modal-body">                <div class="alert alert-info m-b-0">确认重置为魔人布局和样式?</div>            </div>            <div class="modal-footer">                <a href="javascript:;" class="btn btn-sm btn-white" data-dismiss="modal"><i class="fa fa-close"></i> 取消</a>                <a href="javascript:;" class="btn btn-sm btn-inverse" data-click="confirm-reset-local-storage"><i class="fa fa-check"></i> 确定</a>            </div>        </div>    </div></div>';$("body").append(b);$('[data-modal-id="reset-local-storage-confirmation"]').modal("show")});$('[data-modal-id="reset-local-storage-confirmation"]').live("hidden.bs.modal",function(){$('[data-modal-id="reset-local-storage-confirmation"]').remove()});$("[data-click=confirm-reset-local-storage]").live("click",function(b){b.preventDefault();var a=window.location.href;a=a.split("?");a=a[0];localStorage.removeItem(a);window.location.href=document.URL})};var handleIEFullHeightContent=function(){var b=window.navigator.userAgent;var a=b.indexOf("MSIE ");if(a>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)){$('.vertical-box-row [data-scrollbar="true"][data-height="100%"]').each(function(){var d=$(this).closest(".vertical-box-row");var c=$(d).height();$(d).find(".vertical-box-cell").height(c)})}};var handleUnlimitedTabsRender=function(){function c(j,i){var g=parseInt($(j).css("margin-left"));var d=$(j).width();var e=$(j).find("li.active").width();var f=(i>-1)?i:150;var k=0;$(j).find("li.active").prevAll().each(function(){e+=$(this).width()});$(j).find("li").each(function(){k+=$(this).width()});if(e>=d){var h=e-d;if(k!=e){h+=40}$(j).find(".nav.nav-tabs").animate({marginLeft:"-"+h+"px"},f)}if(e!=k&&k>=d){$(j).addClass("overflow-right")}else{$(j).removeClass("overflow-right")}if(e>=d&&k>=d){$(j).addClass("overflow-left")}else{$(j).removeClass("overflow-left")}}function b(e,k){var j=$(e).closest(".tab-overflow");var h=parseInt($(j).find(".nav.nav-tabs").css("margin-left"));var g=$(j).width();var d=0;var i=0;$(j).find("li").each(function(){if(!$(this).hasClass("next-button")&&!$(this).hasClass("prev-button")){d+=$(this).width()}});switch(k){case"next":var f=d+h-g;if(f<=g){i=f-h;setTimeout(function(){$(j).removeClass("overflow-right")},150)}else{i=g-h-80}if(i!=0){$(j).find(".nav.nav-tabs").animate({marginLeft:"-"+i+"px"},150,function(){$(j).addClass("overflow-left")})}break;case"prev":var f=-h;if(f<=g){$(j).removeClass("overflow-left");i=0}else{i=f-g+80}$(j).find(".nav.nav-tabs").animate({marginLeft:"-"+i+"px"},150,function(){$(j).addClass("overflow-right")});break}}function a(){$(".tab-overflow").each(function(){var g=$(this).width();var f=0;var d=$(this);var e=g;$(d).find("li").each(function(){var h=$(this);f+=$(h).width();if($(h).hasClass("active")&&f>g){e-=f}});c(this,0)})}$('[data-click="next-tab"]').live("click",function(d){d.preventDefault();b(this,"next")});$('[data-click="prev-tab"]').live("click",function(d){d.preventDefault();b(this,"prev")});$(window).resize(function(){$(".tab-overflow .nav.nav-tabs").removeAttr("style");a()});a()};var handleMobileSidebar=function(){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){if($("#page-container").hasClass("page-sidebar-minified")){$('#sidebar [data-scrollbar="true"]').css("overflow","visible");$('.page-sidebar-minified #sidebar [data-scrollbar="true"]').slimScroll({destroy:true});$('.page-sidebar-minified #sidebar [data-scrollbar="true"]').removeAttr("style");$(".page-sidebar-minified #sidebar [data-scrollbar=true]").trigger("mouseover")}}var a=0;$(".page-sidebar-minified .sidebar [data-scrollbar=true] a").live("touchstart",function(c){var d=c.originalEvent.touches[0]||c.originalEvent.changedTouches[0];var b=d.pageY;a=b-parseInt($(this).closest("[data-scrollbar=true]").css("margin-top"))});$(".page-sidebar-minified .sidebar [data-scrollbar=true] a").live("touchmove",function(d){d.preventDefault();if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){var f=d.originalEvent.touches[0]||d.originalEvent.changedTouches[0];var b=f.pageY;var c=b-a;$(this).closest("[data-scrollbar=true]").css("margin-top",c+"px")}});$(".page-sidebar-minified .sidebar [data-scrollbar=true] a").live("touchend",function(f){var h=$(this).closest("[data-scrollbar=true]");var g=$(window).height();a=$(h).css("margin-top");var c=0;$(".sidebar").find(".nav").each(function(){c+=$(this).height()});var b=-parseInt(a)+$(".sidebar").height();if(b>=c){var d=g-c;$(h).animate({marginTop:d+"px"})}else{if(parseInt(a)>=0){$(h).animate({marginTop:"0px"})}}return true})};var App=function(){return{init:function(){handleDraggablePanel();handleLocalStorage();handleResetLocalStorage();handleSlimScroll();handleSidebarMenu();handleMobileSidebarToggle();handleSidebarMinify();handleMobileSidebar();handleThemePageStructureControl();handleThemePanelExpand();handleAfterPageLoadAddClass();handlePanelAction();handelTooltipPopoverActivation();handleScrollToTopButton();handlePageContentView();handleIEFullHeightContent();handleUnlimitedTabsRender()}}}();